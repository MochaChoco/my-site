@import "tailwindcss";
@config "../tailwind.config.js";
@plugin "@tailwindcss/typography";

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 221.2 83.2% 53.3%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 210 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 221.2 83.2% 53.3%;
    --radius: 0.5rem;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 217.2 91.2% 59.8%;
    --primary-foreground: 222.2 47.4% 11.2%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 224.3 76.3% 48%;
  }
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: 'Inter', 'Noto Sans KR', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
}

html {
  scroll-behavior: smooth;
  scrollbar-gutter: stable;
}

/* 모든 포스팅 본문 내 이미지 스타일 */
.prose img {
  width: 100%;
  max-width: 800px;
  height: auto;
  margin: 2rem auto;
  border-radius: 0.5rem;
}

/* 포스팅 내 테이블 기본 스타일 */
.prose table {
  width: 100%;
  margin: 1.5rem 0;
  border-collapse: collapse;
  border: 1px solid hsl(var(--border));
}

.prose th,
.prose td {
  border: 1px solid hsl(var(--border));
  padding: 0.5rem 0.75rem;
  text-align: left;
}

/* 코드 블록 스타일 (rehype-pretty-code) */
.prose pre {
  display: flex;
  margin: 1rem 0;
  border-radius: 0.5rem;
  font-size: 0.875rem;
  line-height: 1.5;
  overflow-x: auto;
}

.prose pre > code {
  flex: 1;
  display: grid;
  font-size: 0.875rem;
  line-height: 1.5;
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
}

/* 다크 모드에서 코드 블록 가독성 향상 */
.dark .prose pre {
  background-color: transparent;
}

/* 글 전체가 컨테이너를 벗어나지 않도록 처리 */
.prose {
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
}

/* 다크 모드에서 링크 색상 조정 */
.dark .prose a {
  color: rgb(96 165 250); /* blue-400 */
}

.dark .prose a:hover {
  color: rgb(147 197 253); /* blue-300 */
}

/* 리스트 마커 색상 */
.prose ul > li::marker,
.prose ol > li::marker {
  color: rgb(31 41 55); /* gray-800 */
}

.dark .prose ul > li::marker,
.dark .prose ol > li::marker {
  color: rgb(229 231 235); /* gray-200 */
}

/* 인라인 코드 스타일 (백틱으로 감싼 코드만) */
.prose :not(pre) > code,
.prose h1 code,
.prose h2 code,
.prose h3 code,
.prose h4 code,
.prose h5 code,
.prose h6 code,
.prose p code,
.prose li code {
  color: rgb(219 39 119); /* pink-600 */
  background-color: rgb(243 244 246); /* gray-100 */
  padding: 0.125rem 0.375rem;
  border-radius: 0.25rem;
  font-size: 0.9em;
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
  font-weight: 500;
}

.prose :not(pre) > code::before,
.prose :not(pre) > code::after,
.prose h1 code::before,
.prose h1 code::after,
.prose h2 code::before,
.prose h2 code::after,
.prose h3 code::before,
.prose h3 code::after,
.prose h4 code::before,
.prose h4 code::after,
.prose h5 code::before,
.prose h5 code::after,
.prose h6 code::before,
.prose h6 code::after,
.prose p code::before,
.prose p code::after,
.prose li code::before,
.prose li code::after {
  content: none;
}

.dark .prose :not(pre) > code,
.dark .prose h1 code,
.dark .prose h2 code,
.dark .prose h3 code,
.dark .prose h4 code,
.dark .prose h5 code,
.dark .prose h6 code,
.dark .prose p code,
.dark .prose li code {
  color: rgb(236 72 153); /* pink-500 */
  background-color: rgb(31 41 55); /* gray-800 */
}

/* 인쇄 스타일 */
@media print {
  /* 라이트 모드 CSS 변수 강제 적용 */
  :root,
  .dark {
    --background: 0 0% 100% !important;
    --foreground: 222.2 84% 4.9% !important;
    --card: 0 0% 100% !important;
    --card-foreground: 222.2 84% 4.9% !important;
    --popover: 0 0% 100% !important;
    --popover-foreground: 222.2 84% 4.9% !important;
    --primary: 221.2 83.2% 53.3% !important;
    --primary-foreground: 210 40% 98% !important;
    --secondary: 210 40% 96.1% !important;
    --secondary-foreground: 222.2 47.4% 11.2% !important;
    --muted: 210 40% 96.1% !important;
    --muted-foreground: 215.4 16.3% 46.9% !important;
    --accent: 210 40% 96.1% !important;
    --accent-foreground: 222.2 47.4% 11.2% !important;
    --border: 214.3 31.8% 91.4% !important;
    --input: 214.3 31.8% 91.4% !important;
    --ring: 221.2 83.2% 53.3% !important;
  }

  /* 모든 요소에 배경색 인쇄 허용 */
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }

  html,
  body {
    background: white !important;
    background-color: white !important;
    color: black !important;
    color-scheme: light !important;
  }

  /* 다크 모드 클래스 무효화 */
  .dark {
    background: white !important;
    background-color: white !important;
    color: black !important;
  }

  /* 헤더, 푸터, 목차, 공유 버튼, 네비게이션 숨김 */
  header,
  footer,
  aside,
  nav,
  .share-buttons,
  .scroll-to-top,
  .post-navigation,
  .related-posts,
  .mobile-toc {
    display: none !important;
  }

  /* 본문 레이아웃 최적화 */
  html,
  body {
    width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  main {
    padding: 0 !important;
    margin: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
  }

  main > div {
    padding: 0 !important;
    margin: 0 !important;
    max-width: 100% !important;
  }

  article {
    display: block !important;
    max-width: 100% !important;
    grid-template-columns: 1fr !important;
  }

  /* prose 기본 색상 - 코드 블록 제외 */
  .prose > :not(figure):not(pre),
  .dark .prose > :not(figure):not(pre) {
    color: black !important;
  }

  .prose h1,
  .prose h2,
  .prose h3,
  .prose h4,
  .prose h5,
  .prose h6,
  .dark .prose h1,
  .dark .prose h2,
  .dark .prose h3,
  .dark .prose h4,
  .dark .prose h5,
  .dark .prose h6 {
    color: black !important;
  }

  .prose > p,
  .prose > ul > li,
  .prose > ol > li,
  .prose strong,
  .dark .prose > p,
  .dark .prose > ul > li,
  .dark .prose > ol > li,
  .dark .prose strong {
    color: black !important;
  }

  /* 리스트 마커 */
  .prose > ul > li::marker,
  .prose > ol > li::marker,
  .dark .prose > ul > li::marker,
  .dark .prose > ol > li::marker {
    color: black !important;
  }

  /* 코드 블록 인쇄 최적화 - 원래 테마 유지, 줄바꿈만 처리 */
  pre,
  .prose pre,
  .dark .prose pre {
    overflow-x: visible !important;
    overflow: visible !important;
    border: 1px solid #ccc !important;
    padding: 1rem !important;
  }

  pre code,
  .prose pre code,
  .prose pre > code,
  .dark .prose pre code,
  .dark .prose pre > code {
    white-space: pre-wrap !important;
    overflow-wrap: break-word !important;
  }

  /* 코드 라인이 길 때만 줄바꿈 */
  pre code > span,
  .prose pre code > span,
  .dark .prose pre code > span {
    white-space: pre-wrap !important;
    overflow-wrap: break-word !important;
  }

  /* 코드 블록 wrapper */
  .prose div.relative,
  .dark .prose div.relative {
    background: transparent !important;
  }


  /* 인라인 코드 인쇄 최적화 */
  .prose :not(pre) > code,
  .prose h1 code,
  .prose h2 code,
  .prose h3 code,
  .prose h4 code,
  .prose p code,
  .prose li code,
  .dark .prose :not(pre) > code,
  .dark .prose h1 code,
  .dark .prose h2 code,
  .dark .prose h3 code,
  .dark .prose h4 code,
  .dark .prose p code,
  .dark .prose li code {
    background: #eee !important;
    background-color: #eee !important;
    color: #c7254e !important;
    border: 1px solid #ccc !important;
    padding: 0.1em 0.3em !important;
  }

  /* 링크 스타일 */
  .prose a,
  .dark .prose a {
    color: #0066cc !important;
    text-decoration: underline !important;
  }

  /* 외부 링크 URL 표시 */
  .prose a[href^="http"]::after {
    content: " (" attr(href) ")";
    font-size: 0.75em;
    color: #666 !important;
    word-break: break-all;
  }

  /* 테이블 스타일 */
  .prose table,
  .dark .prose table {
    border: 1px solid #ccc !important;
  }

  .prose th,
  .prose td,
  .dark .prose th,
  .dark .prose td {
    border: 1px solid #ccc !important;
    color: black !important;
  }

  .prose th,
  .dark .prose th {
    background-color: #f5f5f5 !important;
  }

  /* 인용문 */
  .prose blockquote,
  .dark .prose blockquote {
    border-left-color: #ccc !important;
    color: #333 !important;
  }

  /* 이미지 페이지 분리 방지 */
  .prose img {
    break-inside: avoid;
    max-width: 100% !important;
  }

  /* 제목 페이지 분리 방지 */
  .prose h1,
  .prose h2,
  .prose h3,
  .prose h4 {
    break-after: avoid;
  }

  /* 코드 블록 복사 버튼 숨김 */
  .copy-button,
  [class*="copy"] {
    display: none !important;
  }

  /* 제목 영역 스타일 */
  h1,
  time {
    color: black !important;
  }

  .text-muted-foreground {
    color: #666 !important;
  }
}
